(function(e){function t(t){for(var n,a,s=t[0],c=t[1],l=t[2],p=0,f=[];p<s.length;p++)a=s[p],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&f.push(r[a][0]),r[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);u&&u(t);while(f.length)f.shift()();return i.push.apply(i,l||[]),o()}function o(){for(var e,t=0;t<i.length;t++){for(var o=i[t],n=!0,s=1;s<o.length;s++){var c=o[s];0!==r[c]&&(n=!1)}n&&(i.splice(t--,1),e=a(a.s=o[0]))}return e}var n={},r={app:0},i=[];function a(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=e,a.c=n,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(o,n,function(t){return e[t]}.bind(null,n));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;i.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"22b1":function(e,t,o){},"2f7d":function(e,t,o){},"4d2a":function(e,t,o){},"56d7":function(e,t,o){"use strict";o.r(t);o("e260"),o("e6cf"),o("cca6"),o("a79d");var n=o("a026"),r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"}},[o("el-dialog",{attrs:{visible:"","close-on-click-modal":!1,"show-close":!1,title:"Imgpond"}},[o("Imgpond")],1)],1)},i=[],a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"multiple-files"},[o("el-upload",{ref:"element-upload",attrs:{action:"#","auto-upload":!1,"list-type":"picture-card","file-list":e.files,"on-change":e.onChange,"on-preview":e.onActivatefile,"on-remove":e.onRemove,"http-request":e.httpRequest}},[o("i",{staticClass:"el-icon-plus"})]),o("ImgCropper",{attrs:{show:e.cropper.show,file:e.cropper.file,aspectRatio:"1/1",aspectRatioDeviation:.1},on:{"update:show":function(t){return e.$set(e.cropper,"show",t)},confirm:e.onCropperConfirm,cancel:e.onCropperCancel,close:e.onCropperClose,open:e.onCropperOpen,closed:e.onCropperClosed}})],1)},s=[],c=o("1da1"),l=o("3835"),u=o("b85c"),p=o("5530"),f=(o("96cf"),o("d3b7"),o("ddb0"),o("d81d"),o("a434"),o("b0c0"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-dialog",e._g({attrs:{title:"编辑图片",visible:e.show,"close-on-click-modal":!1,"append-to-body":!0,"destroy-on-close":""},on:{close:function(t){return e.$emit("update:show",!1)}}},e.$listeners),[o("vue-cropper",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"cropper",attrs:{"overflow-hidden":"",src:e.src,containerStyle:e.containerStyle,preview:".preview",minContainerHeight:500,background:"",ready:e.onReady,cropmove:e.touch,zoom:e.touch}}),o("div",{attrs:{flex:"","flex-col":"","items-center":"","mt-40px":"","gap-10px":""}},[o("el-button-group",[o("el-button",{attrs:{icon:"el-icon-zoom-in"},on:{click:function(t){return t.preventDefault(),e.zoom(.2)}}}),o("el-button",{attrs:{icon:"el-icon-zoom-out"},on:{click:function(t){return t.preventDefault(),e.zoom(-.2)}}}),o("el-button",{attrs:{icon:"el-icon-arrow-left"},on:{click:function(t){return t.preventDefault(),e.move(-10,0)}}}),o("el-button",{attrs:{icon:"el-icon-arrow-right"},on:{click:function(t){return t.preventDefault(),e.move(10,0)}}}),o("el-button",{attrs:{icon:"el-icon-arrow-up"},on:{click:function(t){return t.preventDefault(),e.move(0,-10)}}}),o("el-button",{attrs:{icon:"el-icon-arrow-down"},on:{click:function(t){return t.preventDefault(),e.move(0,10)}}}),o("el-button",{ref:"flipX",staticClass:"flipX",attrs:{icon:"el-icon-sort"},on:{click:function(t){return t.preventDefault(),e.flipX.apply(null,arguments)}}}),o("el-button",{ref:"flipY",attrs:{icon:"el-icon-sort"},on:{click:function(t){return t.preventDefault(),e.flipY.apply(null,arguments)}}}),o("el-button",{attrs:{icon:"el-icon-refresh-right"},on:{click:function(t){return t.preventDefault(),e.rotate(90)}}}),o("el-button",{attrs:{icon:"el-icon-refresh-left"},on:{click:function(t){return t.preventDefault(),e.rotate(-90)}}}),o("el-button",{attrs:{type:"info",icon:"el-icon-refresh"},on:{click:function(t){return t.preventDefault(),e.reset.apply(null,arguments)}}})],1),o("el-slider",{staticClass:"rotateDegree",attrs:{"show-input":"",min:-180,max:180,marks:{0:"0°","-180":"-180°",180:"180°"}},on:{change:e.onRotateDegreeChange},model:{value:e.rotateDegree,callback:function(t){e.rotateDegree=t},expression:"rotateDegree"}})],1),o("div",{attrs:{slot:"footer",flex:"","items-center":"","justify-end":""},slot:"footer"},[o("el-form",{directives:[{name:"show",rawName:"v-show",value:e.mustCrop,expression:"mustCrop"}],attrs:{inline:"",flex:""}},[e.isLargeResolution?o("el-form-item",[o("template",{slot:"label"},[e._v(" 最大分辨率 "),o("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[o("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 调低该值可缩小图片体积"),o("br"),e._v(" 调高该值可提升清晰度 ")]),o("i",{staticClass:"el-icon-question"})])],1),o("el-input-number",{staticClass:"maxResolution",attrs:{min:0,step:128,size:"mini"},model:{value:e.maxResolution,callback:function(t){e.maxResolution=t},expression:"maxResolution"}})],2):e._e(),o("el-form-item",[o("template",{slot:"label"},[e._v(" 品质 "),o("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[o("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 调低该值可缩小图片体积"),o("br"),e._v(" 调高该值可提升清晰度 ")]),o("i",{staticClass:"el-icon-question"})])],1),o("el-slider",{staticClass:"quality",attrs:{min:0,max:1,step:.1,size:"mini"},model:{value:e.quality,callback:function(t){e.quality=t},expression:"quality"}})],2)],1),o("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"info"},on:{click:e.reset}},[e._v("重 置")]),o("el-button",{on:{click:function(){e.$emit("cancel")}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary",loading:e.submitting},on:{click:e.onConfirm}},[e._v(" 确 定 ")])],1)],1)}),h=[],d=(o("a9e3"),o("ac1f"),o("1276"),o("5319"),o("99af"),o("b680"),o("6107"),o("95c3")),m=o.n(d),v=(o("53ca"),o("2ca0"),o("8a79"),o("3ca3"),o("2b3d"),o("9861"),o("a15b"),Math.pow(1024,2)),g=1024;function b(e){return e>=v?(e/v).toFixed(2)+"M":(e/g).toFixed(2)+"K"}function w(e,t){var o=new FileReader;o.onload=function(e){"function"===typeof t&&t(e.target.result)},o.readAsDataURL(e)}function x(e){return e?Array.isArray(e)?e.map((function(e){return e.replace("/",":")})).join(" ~ "):e.replace("/",":"):""}var C=o("517b"),y=2560,R=function(){return{containerStyle:{height:"500px"},rotateDegree:0,maxResolution:y,quality:1,isTouched:!1}},$=function(){return Object(p["a"])(Object(p["a"])({},R()),{},{loading:!0,aspectRatioMismatched:!1,submitting:!1,src:"",sizeText:"",isLargeResolution:!1,canvas:{},cropBox:{}})},D={props:{show:{type:Boolean,required:!0},file:File,aspectRatio:[Array,String],aspectRatioDeviation:Number},components:{VueCropper:m.a},data:function(){return $()},computed:{aspectRatioText:function(){return x(this.aspectRatioValue)},mustCrop:function(){return this.aspectRatioMismatched||this.isTouched},aspectRatioValue:function(){if(this.aspectRatio&&"string"===typeof this.aspectRatio){var e=this.aspectRatio.split("/"),t=Object(l["a"])(e,2),o=t[0],n=t[1];return o/n}}},watch:{file:function(e,t){var o=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e){t.next=9;break}if(!o.aspectRatioValue){t.next=5;break}return t.next=4,o.checkAspectRatio(e);case 4:o.aspectRatioMismatched=t.sent;case 5:o.sizeText=b(e.size),w(e,(function(e){var t=new Image;t.onload=function(){var e=t.width,n=t.height;o.isLargeResolution=e>=y||n>=y},t.src=e,o.src=e,o.$refs.cropper.replace(e)})),t.next=10;break;case 9:Object.assign(o.$data,$());case 10:case"end":return t.stop()}}),t)})))()}},methods:{onRotateDegreeChange:function(e){var t=this;this.touch(),this.updateCropBox||(this.updateCropBox=Object(C["a"])((function(e){t.$refs.cropper.rotateTo(e),t.$nextTick((function(){var e=t.$refs.cropper.getCanvasData(),o=e.width,n=e.height,r=e.left,i=e.top;t.$refs.cropper.setCropBoxData({width:o,height:n,left:r,top:i})}))}),Math.min(300,Math.round(this.file.size/g)),{leading:!1,trailing:!0})),this.file&&this.updateCropBox(e)},getSizeDiffText:function(e,t){var o=t-e,n="原图体积 ".concat(b(e),"，编辑后 ").concat(b(t)),r=0===o?"":"".concat((o/e*100).toFixed(2),"%");return o>0&&(r="+"+r),r&&(r="（".concat(r,"）")),n+r},checkAspectRatio:function(e){var t=this;return new Promise((function(o){var n=new FileReader;n.onload=function(e){var n=new Image;n.onload=function(){var e=n.width/n.height;o(e<t.aspectRatioValue*(1-t.aspectRatioDeviation)||e>t.aspectRatioValue*(1+t.aspectRatioDeviation))},n.src=e.target.result},n.readAsDataURL(e)}))},onConfirm:function(){var e=this;this.mustCrop?(this.submitting=!0,this.$refs.cropper.getCroppedCanvas({maxWidth:this.maxResolution,maxHeight:this.maxResolution}).toBlob((function(t){var o=e.getSizeDiffText(e.file.size,t.size);console.log(o),e.$emit("confirm",t),e.submitting=!1}),this.file.type,this.quality)):this.$emit("confirm")},touch:function(){this.isTouched=!0},onReady:function(){var e=this,t=this.$refs.cropper.getCanvasData(),o=t.width,n=t.height,r=t.left,i=t.top;"number"===typeof this.aspectRatioValue?(this.$refs.cropper.setAspectRatio(this.aspectRatioValue),this.$nextTick((function(){var t=o/n;if(e.aspectRatioValue>t){e.$refs.cropper.setCropBoxData({width:o,left:r});var a=e.$refs.cropper.getContainerData(),s=(a.width,a.height),c=e.$refs.cropper.getCropBoxData(),l=(c.width,c.height);e.$refs.cropper.setCropBoxData({top:(s-l)/2})}else{e.$refs.cropper.setCropBoxData({height:n,top:i});var u=e.$refs.cropper.getContainerData(),p=u.width,f=(u.height,e.$refs.cropper.getCropBoxData()),h=f.width;f.height;e.$refs.cropper.setCropBoxData({left:(p-h)/2})}e.loading=!1}))):(this.$refs.cropper.setCropBoxData({width:o,height:n,left:r,top:i}),this.loading=!1)},flipX:function(){this.touch();var e=this.$refs.flipX.$el,t=e.getAttribute("data-scale");t=t?-t:-1,this.$refs.cropper.scaleX(t),e.setAttribute("data-scale",t)},flipY:function(){this.touch();var e=this.$refs.flipY.$el,t=e.getAttribute("data-scale");t=t?-t:-1,this.$refs.cropper.scaleY(t),e.setAttribute("data-scale",t)},move:function(e,t){this.touch(),this.$refs.cropper.move(e,t)},reset:function(){Object.assign(this.$data,R()),this.$refs.cropper.reset(),this.onReady()},rotate:function(e){var t=this.rotateDegree+e;this.rotateDegree=t>180?t-360:t<-180?t+360:t,this.onRotateDegreeChange(this.rotateDegree)},zoom:function(e){this.$refs.cropper.relativeZoom(e)}}},k=D,O=(o("8e17"),o("2877")),j=Object(O["a"])(k,f,h,!1,null,"1c16f9fa",null),_=j.exports,A=o("bc3a"),z=o.n(A),B={name:"Imgpond",components:{ImgCropper:_},data:function(){return{files:[{url:"https://placem.at/people?random=1&txt=0&w=500&h=500"},{url:"https://placem.at/people?random=1&txt=0&w=1000&h=500"}],cropper:{show:!1,file:null,loading:!1,submitted:!1}}},methods:{onChange:function(e,t){"ready"===e.status&&(console.log(t,"fileList"),this.beforeAddFile(Object(p["a"])(Object(p["a"])({},e),{},{file:e.raw,fileList:t})))},beforeAddFile:function(e){if(e.file instanceof File){if(this.cropper.show)return;this.cropper.file=e.file,this.cropper.show=!0}},onActivatefile:function(e){var t,o=Object(u["a"])(this.files.entries());try{for(o.s();!(t=o.n()).done;){var n=Object(l["a"])(t.value,2),r=n[0],i=n[1];if(i.url===e.url){this.preview(r);break}}}catch(a){o.e(a)}finally{o.f()}},preview:function(e){this.$viewerApi({options:{toolbar:!0,initialViewIndex:e},images:this.files.map((function(e){return e.url}))})},onRemove:function(e,t){this.files.splice(t.indexOf(e),1)},onSuccess:function(e,t,o){t.progress=100,t.url=e,this.files.push(t)},uploadImg:function(e){var t=new FormData;return t.append("file",e),t.append("dir","img"),t.append("domainId","3"),t.append("original","true"),z.a.post("https://www.lanshan-h5.cn:1443/node//upload",t,{timeout:2e4}).then((function(e){return e.data.data})).catch((function(e){reject(e)}))},httpRequest:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:w(e.file,(function(o){t.onSuccess(o,e.file)}));case 1:case"end":return o.stop()}}),o)})))()},onCropperCancel:function(){this.cropper.show=!1},onCropperConfirm:function(e){var t=this.$refs["element-upload"];if(e){var o=new File([e],this.cropper.file.name,{type:e.type}),n=t.uploadFiles[t.uploadFiles.length-1];o.uid=n.raw.uid,n.raw=o}t.submit(),this.cropper.submitted=!0,this.onCropperCancel(!1)},onCropperClose:function(){var e=this.$refs["element-upload"].uploadFiles;e.splice(e.indexOf(this.cropper.file),1),!this.cropper.submitted&&this.$refs["element-upload"].submit(),this.cropper.file=null,this.cropper.submitted=!1},onCropperClosed:function(){this.$refs["element-upload"].$refs["upload-inner"].$el.focus()},onCropperOpen:function(){this.$refs["element-upload"].$refs["upload-inner"].$el.blur()}}},F=B,S=(o("6aa5"),o("efb9"),Object(O["a"])(F,a,s,!1,null,"3d6add62",null)),T=S.exports,q={components:{Imgpond:T}},I=q,M=(o("7dd1"),Object(O["a"])(I,r,i,!1,null,"34eb5e5c",null)),V=M.exports,P=o("5c96"),L=o.n(P),X=(o("0fae"),o("0808"),o("6944")),Y=o.n(X);n["default"].use(L.a),n["default"].use(Y.a),n["default"].config.productionTip=!1,new n["default"]({render:function(e){return e(V)}}).$mount("#app")},"6aa5":function(e,t,o){"use strict";o("2f7d")},"7dd1":function(e,t,o){"use strict";o("22b1")},"8e17":function(e,t,o){"use strict";o("f811")},efb9:function(e,t,o){"use strict";o("4d2a")},f811:function(e,t,o){}});